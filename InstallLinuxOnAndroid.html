<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns="http://www.w3.org/1999/xhtml" xmlns:x="http://www.texmacs.org/2002/extensions">
  <head>
    <title>No title</title>
    <meta content="TeXmacs 1.99.2" name="generator"></meta>
    <style type="text/css">
      body { text-align: justify } h5 { display: inline; padding-right: 1em }
      h6 { display: inline; padding-right: 1em } table { border-collapse:
      collapse } td { padding: 0.2em; vertical-align: baseline } .subsup {
      display: inline; vertical-align: -0.2em } .subsup td { padding: 0px;
      text-align: left} .fraction { display: inline; vertical-align: -0.8em }
      .fraction td { padding: 0px; text-align: center } .wide { position:
      relative; margin-left: -0.4em } .accent { position: relative;
      margin-left: -0.4em; top: -0.1em } .title-block { width: 100%;
      text-align: center } .title-block p { margin: 0px } .compact-block p {
      margin-top: 0px; margin-bottom: 0px } .left-tab { text-align: left }
      .center-tab { text-align: center } .balloon-anchor { border-bottom: 1px
      dotted #000000; outline:none;                  cursor: help; position:
      relative; }.balloon-anchor [hidden] { margin-left: -999em; position:
      absolute; display: none; }.balloon-anchor:hover [hidden] { position:
      absolute; left: 1em; top: 2em; z-index: 99; margin-left: 0; width:
      500px; display: inline-block; }.balloon-body { }.ornament  {
      border-width: 1px; border-style: solid; border-color:  black; display:
      inline-block; padding: 0.2em; } .right-tab { float: right; position:
      relative; top: -1em } 
    </style>
  </head>
  <body>
    <table class="title-block">
      <tr>
        <td><table class="title-block">
          <tr>
            <td><font size="+3"><b>&#x5728; Android
            &#x8A2D;&#x5099;&#x4E0A;&#x5B89;&#x88DD; GNU/Linux Chroot
            &#x74B0;&#x5883;</b></font></td>
          </tr>
        </table><p style="margin-top: 1em; margin-bottom: 1em">
          <div class="compact-block">
            <table class="title-block">
              <tr>
                <td><p style="margin-top: 0.5em; margin-bottom: 0.5em">
                  <span style="margin-left: 0pt"></span>
                  <table style="display: inline; vertical-align: -0.55em">
                    <tbody><tr>
                      <td style="text-align: center; padding-left: 0em; padding-right: 0em; padding-bottom: 0em; padding-top: 0em; width: 100%"><center>
                        <p>
                          <class style="font-variant: small-caps">by 910JQK</class>
                        </p>
                      </center></td>
                    </tr></tbody>
                  </table>
                </p><p style="margin-top: 0.5em; margin-bottom: 0.5em">
                  <span style="margin-left: 0pt"></span>
                  <table style="display: inline; vertical-align: -0.55em">
                    <tbody><tr>
                      <td style="text-align: center; padding-left: 0em; padding-right: 0em; padding-bottom: 0em; padding-top: 0em; width: 100%"><center>
                        <p>
                          August 2013
                        </p>
                      </center></td>
                    </tr></tbody>
                  </table>
                </p></td>
              </tr>
            </table>
          </div>
        </p></td>
      </tr>
    </table>
    <p>
      
    </p>
    <p>
      &#x5728; Android &#x8A2D;&#x5099;&#x4E0A;&#x5B89;&#x88DD; GNU/Linux
      Chroot &#x74B0;&#x5883;
    </p>
    <p>
      Install GNU/Linux Chroot Environment on Android Device
    </p>
    <p>
      
    </p>
    <p>
      (My English is not good, the translation is just parctice.)
    </p>
    <p>
      
    </p>
    <p>
      &#x5728; Android &#x4E0A;&#x5B89;&#x88DD; Linux&#xFF0C;
      &#x9019;&#x4E26;&#x4E0D;&#x662F;&#x4E00;&#x9805;&#x591A;&#x9EBC;&#x8907;&#x96DC;&#x7684;&#x6280;&#x8853;&#xFF0C;&#x53EA;&#x662F;&#x6709;&#x4E9B;&#x5730;&#x65B9;&#x53EF;&#x80FD;&#x6709;&#x4E9B;&#x969C;&#x7919;&#x3002;
    </p>
    <p>
      It is not difficult to install Linux on Android, there're just few
      obstacles.
    </p>
    <p>
      
    </p>
    <p>
      &#x56E0;&#x6B64;&#x672C;&#x6587;&#x4E26;&#x4E0D;&#x662F;&#x4E00;&#x7BC7;&#x5B8C;&#x6574;&#x7684;&#x6559;&#x7A0B;&#x6216;&#x6587;&#x6A94;&#xFF0C;&#x53EA;&#x662F;&#x7528;&#x65BC;&#x6307;&#x9EDE;&#x4E00;&#x4E0B;&#xFF0C;&#x6211;&#x76F8;&#x4FE1;&#x5404;&#x4F4D;&#x7684;&#x6280;&#x8853;&#x6C92;&#x6709;&#x554F;&#x984C;&#x3002;
    </p>
    <p>
      So the article is not a complete tutorial or document. It's only used
      for giving ideas. I believe your skill.
    </p>
    <p>
      
    </p>
    <p>
      &#x9996;&#x5148;&#x662F;&#x67B6;&#x69CB;&#x4E0D;&#x540C;&#x7684;&#x554F;&#x984C;&#xFF0C;&#x6240;&#x4EE5;&#x88DD;
      ARM
      &#x7248;&#x662F;&#x5FC5;&#x9808;&#x7684;&#x3002;&#x672C;&#x6587;&#x7684;
      GNU/Linux &#x4EE5; ArchLinuxARM &#x70BA;&#x4F8B;&#xFF0C;&#x7FD2;&#x6163;
      Debian &#x7684;&#x540C;&#x5B78;&#x53EF;&#x4EE5;&#x5617;&#x8A66; Debian
      ARM.
    </p>
    <p>
      Firstly, there is a problem that the architecture is not X86 so that the
      ARM edition is required.  I selected Archlinux ARM as GNU/Linux for
      example. If you prefer Debian, you can try Debian ARM.
    </p>
    <h2 id="auto-1">1<span style="margin-left: 1em"></span>&#x6E96;&#x5099;&#x5DE5;&#x4F5C;</h2>
    <p>
      &#x4F60;&#x9700;&#x8981;&#x4E00;&#x500B;&#x5DF2; ROOT &#x4E26;&#x6709;
      busybox &#x7684; android
      &#x8A2D;&#x5099;/&#x88DD;&#x7F6E;&#xFF08;&#x5EE2;&#x8A71;&#xFF09;&#xFF0C;&#x4E00;&#x81FA;&#x4F7F;&#x7528;
      GNU/Linux
      &#x7684;&#x96FB;&#x8166;&#xFF0C;&#x9084;&#x6709;&#x4E00;&#x500B;&#x8ABF;&#x8A66;&#x5DE5;&#x5177;&#x3002;&#x9019;&#x500B;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x662F;
      adb(android-debug-bridge)&#xFF0C; ssh
      &#x7B49;&#x7B49;&#xFF0C;&#x7528;&#x4F86;&#x5F9E;&#x96FB;&#x8166;&#x4E0A;&#x8F38;&#x5165;&#x547D;&#x4EE4;&#xFF08;&#x66F4;&#x65B9;&#x4FBF;&#xFF09;&#x4EE5;&#x53CA;&#x6A94;&#x6848;/&#x6587;&#x4EF6;&#x7684;&#x50B3;&#x9001;&#x3002;&#x7576;&#x7136;&#x5982;&#x679C;&#x4F60;&#x8981;&#x7528;
      FTP/HTTP/&#x76F4;&#x63A5;&#x62D4;&#x5361;&#x4E5F;&#x53EF;&#x4EE5;&#x3002;
    </p>
    <p>
      You need a rootted  Android device with busybox, a PC with GNU/Linux,
      and a debug tool. The tool can be adb(android-debug-bridge), ssh, and so
      on to type commands on PC and transfer files.  Of course you can also
      use FTP/HTTP/SDCARD(directly).
    </p>
    <p>
      
    </p>
    <p>
      &#x9084;&#x6709;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x4E00;&#x500B;&#x57FA;&#x672C;&#x7CFB;&#x7D71;&#x7684;&#x93E1;&#x50CF;&#x5305;&#x3002;&#x5230;
      <em>os.archlin<tt class="verbatim"></tt>uxarm.org/os/<strong></strong></em>
      &#x627E;&#x4E00;&#x500B;&#x5408;&#x9069;&#x7684;&#x4E0B;&#x8F09;&#xFF0C;&#x6211;&#x7528;&#x7684;
      http://archlinuxarm.org/os/ArchLinuxARM-oxnas-latest.tar.gz
      &#x5728;&#x6211;&#x7684;&#x624B;&#x6A5F;&#x4E0A;&#x6C92;&#x6709;&#x554F;&#x984C;&#x3002;&#x9019;&#x5305;&#x8C8C;&#x4F3C;&#x662F;
      ARMv6
      &#x7684;&#xFF0C;&#x800C;&#x4E14;&#x5F88;&#x8001;&#xFF0C;&#x6700;&#x597D;&#x627E;&#x500B;&#x65B0;&#x7684;&#x3002;
    </p>
    <p>
      And you need a image package of base system. Download it from
      os.archlinuxarm.org/os/. I selected
      http://archlinuxarm.org/os/ArchLinuxARM-oxnas-latest.tar.gz, it works
      fine on my mobile.  The packages seem to be ARMv6 and a little
      out-of-date, I suggest you search a new one.
    </p>
    <p>
      
    </p>
    <p>
      &#x6CE8;&#x610F;&#xFF1A;&#x672C;&#x6587;&#x4E2D;&#x7684;&#x300C;&#x93E1;&#x50CF;&#x300D;&#x548C;&#x300C;&#x93E1;&#x50CF;&#x5305;&#x300D;&#x6307;&#x7684;&#x4E0D;&#x662F;&#x4E00;&#x500B;&#x6771;&#x897F;&#x3002;
    </p>
    <p>
      Notice:These &quot;Image&quot; and &quot;Image Package&quot; here are
      not the same thing.
    </p>
    <h2 id="auto-2">2<span style="margin-left: 1em"></span>&#x88FD;&#x4F5C;&#x93E1;&#x50CF;</h2>
    <p>
      &#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;SD
      &#x5361;&#x53EF;&#x662F;&#x5751;&#x7239;&#x7684; FAT32
      &#x6A94;&#x6848;&#x7CFB;&#x7D71;/&#x6587;&#x4EF6;&#x7CFB;&#x7D71;&#xFF0C;&#x4E0D;&#x652F;&#x6301;&#x6B0A;&#x9650;&#x548C;&#x8EDF;&#x9023;&#x63A5;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x9700;&#x8981;dd&#x51FA;&#x4E00;&#x500B;&#x93E1;&#x50CF;&#x6A94;&#x6848;/&#x6587;&#x4EF6;&#x4F86;&#x76DB;&#x653E;&#x4F60;
      Linux &#x7684;&#x7CFB;&#x7D71;&#x3002;
    </p>
    <p>
      Notice that SD card uses bad FAT32 filesystem, which do not support
      PERMISSION and SYMBOL LINK. So you need to use dd to make a image file
      saving your Linux system.
    </p>
    <p>
      
    </p>
    <p>
      [code]
    </p>
    <p>
      dd if=/dev/zero of=&#x93E1;&#x50CF; bs=4M
      count=&#x5927;&#x5C0F;(MB)&#x9664;&#x4EE5;4
    </p>
    <p>
      #&#x6CE8;&#xFF1A;&#x5927;&#x5C0F;&#x662F;&#x81EA;&#x8A02;&#x7684;&#xFF0C;&#x4F46;&#x8981;&#x6CE8;&#x610F;&#x592A;&#x5927;&#x6703;&#x6E1B;&#x5C11;
      sd
      &#x5361;&#x7684;&#x4E00;&#x822C;&#x53EF;&#x7528;&#x7A7A;&#x9593;(&#x56E0;&#x70BA;&#x9019;&#x500B;&#x93E1;&#x50CF;&#x6A94;&#x6848;/&#x6587;&#x4EF6;&#x8981;&#x5B8C;&#x5168;&#x586B;&#x6EFF;&#x5B83;&#x7684;&#x5927;&#x5C0F;)&#xFF0C;&#x53EF;&#x80FD;&#x6703;&#x4E0D;&#x5920;&#x4F7F;&#xFF0C;&#x9078;&#x64C7;&#x5927;&#x5C0F;&#x6642;&#x4E0D;&#x8981;&#x592A;&#x96A8;&#x610F;&#x3002;
    </p>
    <p>
      dd if=/dev/zero of=IMAGE bs=4M count=SIZE(MB) DEVIDE 4
    </p>
    <p>
      #Tip: The SIZE is custom, but notice that too big size may cause low
      avail space (for the image filling its size completely). So don't choose
      the SIZE casually.
    </p>
    <p>
      
    </p>
    <p>
      mkfs.ext2 &#x93E1;&#x50CF;
    </p>
    <p>
      #&#x628A;&#x93E1;&#x50CF;&#x683C;&#x5F0F;&#x5316;&#x6210;ext2&#x683C;&#x5F0F;&#x3002;&#x56E0;&#x70BA;&#x65E5;&#x8A8C;&#x983B;&#x7E41;&#x8B80;&#x5BEB;&#x5C0D;&#x5361;&#x4E0D;&#x5229;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x7528;
      ext3/ext4/btrfs&#x3002;
    </p>
    <p>
      mkfs.ext2 IMAGE
    </p>
    <p>
      #Format the image file into ext2. As reading and writing frequently is
      bad for the card, don't use journal filesystems such as ext3, ext4 or
      btrfs.
    </p>
    <p>
      [/code]
    </p>
    <h2 id="auto-3">3<span style="margin-left: 1em"></span>&#x5B89;&#x88DD;&#x8207;&#x914D;&#x7F6E;&#x7CFB;&#x7D71;</h2>
    <p>
      &#x56E0;&#x70BA;&#x662F; chroot
      &#x74B0;&#x5883;&#xFF0C;&#x7CFB;&#x7D71;&#x4E0D;&#x7528;&#x5553;&#x52D5;&#xFF0C;&#x6240;&#x4EE5;&#x904E;&#x7A0B;&#x6BD4;&#x5B89;&#x88DD;ARCH(x86)&#x66F4;&#x7C21;&#x55AE;&#x3002;
    </p>
    <p>
      Because of chroot, the operating system can be used without boot so that
      it is easier than installing ARCH(x86).
    </p>
    <p>
      
    </p>
    <p>
      &#x5148;&#x662F;&#x639B;&#x8F09;&#x4E0A;&#x93E1;&#x50CF;&#xFF1A;
    </p>
    <p>
      Firstly, mount the image:
    </p>
    <p>
      
    </p>
    <p>
      [code]
    </p>
    <p>
      mount &#x93E1;&#x50CF; &#x639B;&#x8F09;&#x76EE;&#x9304;
    </p>
    <p>
      mount IMAGE MOUNT-DIR
    </p>
    <p>
      [/code]
    </p>
    <p>
      
    </p>
    <p>
      &#x7136;&#x5F8C;&#x89E3;&#x958B;&#x4E0B;&#x8F09;&#x7684;&#x57FA;&#x672C;&#x7CFB;&#x7D71;&#x93E1;&#x50CF;&#x5305;&#x6A94;&#x6848;/&#x6587;&#x4EF6;&#x5230;&#x639B;&#x8F09;&#x76EE;&#x9304;&#x3002;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;
      (pacman.conf mirrorlist locale.gen)
    </p>
    <p>
      Then, unpack the base system image package into MOUNT-DIR. Modify the
      configuration files (e.g. pacman.conf mirrorlist locale.gen).
    </p>
    <p>
      
    </p>
    <p>
      &#x63A5;&#x7740;&#x5C31;&#x662F;&#x5BEB;&#x5E7E;&#x500B;&#x8173;&#x672C;&#x4F86;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;&#x5B83;&#x3002;
    </p>
    <p>
      And write some scripts for convenience.
    </p>
    <p>
      
    </p>
    <p>
      &#x9032;&#x5165;Android&#x7684;Shell&#xFF1A;
    </p>
    <p>
      Enter Android's shell:
    </p>
    <p>
      
    </p>
    <p>
      [code]
    </p>
    <p>
      su
    </p>
    <p>
      
    </p>
    <p>
      mount -o remount,rw /system
    </p>
    <p>
      
    </p>
    <p>
      mkdir /system/mnt
    </p>
    <p>
      #&#x93E1;&#x50CF;&#x6A94;&#x6848;/&#x6587;&#x4EF6;&#x5728; Android
      &#x4E0A;&#x7684;&#x639B;&#x8F09;&#x76EE;&#x9304;
    </p>
    <p>
      #The MOUNT-DIR of image file (on Android)
    </p>
    <p>
      
    </p>
    <p>
      vi /system/xbin/arch
    </p>
    <p>
      [/code]
    </p>
    <p>
      
    </p>
    <p>
      &#x5BEB;&#x5165;&#x4EE5;&#x4E0B;&#x5167;&#x5BB9;:
    </p>
    <p>
      Write down the content:
    </p>
    <p>
      
    </p>
    <p>
      [code]
    </p>
    <p>
      #!/system/bin/mksh
    </p>
    <p>
      if ( mountpoint -q /system/mnt ) ;then
    </p>
    <p>
      chroot /system/mnt/ /bin/bash
    </p>
    <p>
      #&#x82E5;&#x5DF2;&#x7D93;&#x639B;&#x8F09;&#x5C31;&#x76F4;&#x63A5;
      chroot
    </p>
    <p>
      #If mounted, chroot directly.
    </p>
    <p>
      else
    </p>
    <p>
      mknod /dev/loop256 b 7 256
    </p>
    <p>
      losetup /dev/loop256 /mnt/sdcard/IMAGE
    </p>
    <p>
      mount -t ext2 /dev/loop256 /system/mnt/
    </p>
    <p>
      #&#x639B;&#x8F09;&#x93E1;&#x50CF;&#x3002;&#x8A18;&#x5F97;&#x628A;&#x300C;IMAGE&#x300D;&#x6539;&#x6210;&#x4F60;&#x7684;&#x93E1;&#x50CF;&#x8DEF;&#x5F91;&#x3002;
    </p>
    <p>
      #Mount the image. Remember to change IMAGE into your path.
    </p>
    <p>
      mount -o bind /dev /system/mnt/dev
    </p>
    <p>
      mount -o bind /proc /system/mnt/proc
    </p>
    <p>
      mount -o bind /sys /system/mnt/sys
    </p>
    <p>
      #&#x7D81;&#x5B9A; chroot
      &#x9700;&#x8981;&#x7684;&#x76EE;&#x9304;(API filesystems)
    </p>
    <p>
      #Bind directories for chroot (API filesystems).
    </p>
    <p>
      #&#x7576;&#x7136;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x9078;&#x64C7;&#x7D81;&#x4E0A;&#x4F60;&#x7684;sd&#x5361;&#x4E0A;&#x7684;&#x4E00;&#x4E9B;&#x76EE;&#x9304;
    </p>
    <p>
      #Of course, you can also bind some directories on your SD card if
      you want.
    </p>
    <p>
      chroot /system/mnt/ /bin/bash
    </p>
    <p>
      #Chroot
    </p>
    <p>
      fi
    </p>
    <p>
      [/code]
    </p>
    <p>
      
    </p>
    <p>
      &#x6E2C;&#x8A66;&#x4E0B;&#xFF1A;
    </p>
    <p>
      Take a test:
    </p>
    <p>
      
    </p>
    <p>
      [code]
    </p>
    <p>
      chmod +x /system/xbin/arch
    </p>
    <p>
      arch
    </p>
    <p>
      [/code]
    </p>
    <p>
      
    </p>
    <p>
      &#x770B;&#x770B;&#x884C;&#x4E0D;&#x884C;&#xFF1F;
    </p>
    <p>
      Check if it works.
    </p>
    <h2 id="auto-4">4<span style="margin-left: 1em"></span>&#x6EFE;</h2>
    <p>
      &#x5982;&#x679C;&#x4F60;&#x9078;&#x7684;&#x662F;
      Debian&#xFF0C;&#x90A3;&#x9EBC;&#x606D;&#x559C;&#x4F60;&#x5DF2;&#x7D93;&#x4E0D;&#x9700;&#x8981;&#x9019;&#x6B65;&#x4E86;&#x3002;&#x4E0D;&#x904E;
      ARCH
      &#x561B;&#xFF0C;&#x672C;&#x6027;&#x96E3;&#x79FB;&hellip;&#x5982;&#x679C;&#x4F60;&#x4E0B;&#x7684;&#x662F;&#x4E00;&#x500B;&#x8F03;&#x8001;&#x7684;&#x93E1;&#x50CF;&#x5305;(&#x6BD4;&#x5982;&#x6211;&#x4E0B;&#x7684;&#x9019;&#x500B;)&#xFF0C;&#x5C31;&#x5FC5;&#x9808;&#x8981;&#x6EFE;&#xFF0C;&#x9084;&#x5F97;&#x770B;&#x516C;&#x544A;&#x624B;&#x52D5;&#x5E72;&#x6D89;&hellip;233&#x3002;
    </p>
    <p>
      If you chose debian, congratulations, you don't need to do this step
      now. But ARCH&hellip; Inwardness cannot move. If the image package you
      downloaded is out-of-date, it must be upgraded and intervened manually
      according to announcement&hellip;233(ahaha)!
    </p>
    <p>
      
    </p>
  </body>
</html>